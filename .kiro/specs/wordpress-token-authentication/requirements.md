# Requirements Document

## Introduction

This specification addresses the WordPress token authentication issue in the Gemini WP-Agent project. The system currently has a fully functional conversational AI backend and frontend, but fails to authenticate with the real WordPress site (https://nicoarche.com) due to incorrect token configuration.

## Glossary

- **Gemini_WP_Agent**: The complete system including webapp, backend server, and WordPress plugin
- **WordPress_Plugin**: The Gemini WP-CLI Bridge v2.0 plugin installed on the WordPress site
- **Webapp**: The frontend application running on localhost:3001
- **Token**: The authentication key generated by the WordPress plugin for API access
- **Real_WordPress_Site**: The production WordPress site at https://nicoarche.com

## Requirements

### Requirement 1: Token Retrieval

**User Story:** As a developer, I want to retrieve the real authentication token from my WordPress plugin, so that I can authenticate API requests properly.

#### Acceptance Criteria

1. WHEN accessing the WordPress admin panel, THE WordPress_Plugin SHALL display the current token in the Gemini Token settings page
2. WHEN making a GET request to `/wp-json/gemini/v1/get-token`, THE WordPress_Plugin SHALL return the current authentication token
3. WHEN the token is displayed, THE WordPress_Plugin SHALL show it in a copyable format for easy configuration
4. THE WordPress_Plugin SHALL generate a unique token automatically upon activation
5. WHEN the plugin is active, THE Token SHALL remain consistent across requests until manually regenerated

### Requirement 2: Webapp Configuration Cleanup

**User Story:** As a user, I want to clean the existing site configuration in the webapp, so that I can reconfigure it with the correct token.

#### Acceptance Criteria

1. WHEN accessing the webapp configuration, THE Webapp SHALL allow removal of existing site configurations
2. WHEN a site configuration is removed, THE Webapp SHALL clear all associated data from localStorage
3. WHEN the configuration is cleared, THE Webapp SHALL reset to the initial setup state
4. THE Webapp SHALL not retain any cached authentication data after configuration cleanup
5. WHEN starting fresh configuration, THE Webapp SHALL prompt for new site details

### Requirement 3: WordPress Site Authentication

**User Story:** As a user, I want to configure my webapp with the real WordPress token, so that I can execute commands on my live WordPress site.

#### Acceptance Criteria

1. WHEN configuring a new site, THE Webapp SHALL accept the real token from the WordPress plugin
2. WHEN the correct token is provided, THE Webapp SHALL successfully authenticate with the Real_WordPress_Site
3. WHEN authentication succeeds, THE Webapp SHALL return HTTP 200 responses instead of 401 errors
4. THE Webapp SHALL store the valid token securely for subsequent requests
5. WHEN executing commands, THE Webapp SHALL use the real token for all WordPress API calls

### Requirement 4: Connection Verification

**User Story:** As a user, I want to verify that my webapp is connected to the real WordPress site, so that I can confirm the authentication is working properly.

#### Acceptance Criteria

1. WHEN executing a test command like "Show WordPress version", THE Webapp SHALL return real data from the WordPress site
2. WHEN the connection is successful, THE Webapp SHALL display actual WordPress information (not demo data)
3. WHEN authentication fails, THE Webapp SHALL provide clear error messages indicating the token issue
4. THE Webapp SHALL distinguish between demo mode and real WordPress connection in the UI
5. WHEN connected to real WordPress, THE Webapp SHALL execute all available commands successfully

### Requirement 5: Error Handling and Debugging

**User Story:** As a developer, I want clear error messages and debugging information, so that I can troubleshoot authentication issues effectively.

#### Acceptance Criteria

1. WHEN authentication fails, THE Webapp SHALL log detailed error information to the browser console
2. WHEN a 401 error occurs, THE Webapp SHALL suggest checking the token configuration
3. THE WordPress_Plugin SHALL log authentication attempts to the WordPress debug log
4. WHEN token validation fails, THE System SHALL provide specific guidance on token retrieval
5. THE Webapp SHALL display connection status clearly in the user interface