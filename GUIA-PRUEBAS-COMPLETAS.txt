===============================================================================
üß™ GU√çA COMPLETA DE PRUEBAS - GEMINI WP-AGENT INDUSTRIAL
===============================================================================

Esta gu√≠a te permitir√° probar todas las funcionalidades implementadas en la 
aplicaci√≥n de grado industrial, incluyendo memoria, auto-healing, rate limiting,
capacidades de dise√±o y todas las mejoras de estabilidad.

===============================================================================
üìã PREPARACI√ìN INICIAL
===============================================================================

1. VERIFICAR REQUISITOS PREVIOS:
   ‚úÖ WordPress instalado y funcionando
   ‚úÖ Plugin Gemini WP-CLI instalado y activado
   ‚úÖ Token de seguridad configurado en el plugin
   ‚úÖ Servidor Node.js ejecut√°ndose (puerto 3001)
   ‚úÖ API Key de Gemini configurada en .env

2. ‚ö†Ô∏è ACTUALIZACIONES CR√çTICAS APLICADAS:
   - Modelo actualizado: gemini-1.5-flash ‚Üí gemini-2.5-flash
   - Endpoint faltante: /api/wp-cli/execute ‚Üí ‚úÖ Creado
   - L√≠mite consultas: 3/hora ‚Üí 50/hora (para pruebas extensivas)
   - Estado: ‚úÖ Todos los problemas corregidos autom√°ticamente

3. INICIAR EL SERVIDOR:
   ```
   cd web-app
   npm start
   ```
   
4. ABRIR LA APLICACI√ìN:
   - Navegador: http://localhost:3001
   - Verificar que aparece el mensaje de bienvenida de Gemini WP-Agent

===============================================================================
üîß PRUEBA 1: CONFIGURACI√ìN Y CONEXI√ìN INICIAL
===============================================================================

OBJETIVO: Verificar que la configuraci√≥n de sitios funciona correctamente

PASOS:
1. Hacer clic en el bot√≥n ‚öôÔ∏è (configuraci√≥n)
2. Completar el formulario "A√±adir Nuevo Sitio":
   - Nombre del Sitio: "Mi Sitio de Pruebas"
   - URL de WordPress: https://tu-sitio.com
   - Token de Seguridad: HACKATHON_GEMINI_2025_SECURE_KEY
   - Gemini API Key: (dejar vac√≠o para usar la compartida)

3. Hacer clic en "A√±adir Sitio"

RESULTADOS ESPERADOS:
‚úÖ Mensaje "‚úÖ Sitio a√±adido y configurado correctamente"
‚úÖ Autodiagn√≥stico se ejecuta autom√°ticamente
‚úÖ Aparece mensaje de modo (Emulaci√≥n o WP-CLI Real)
‚úÖ Indicador de estado en el header (üõ°Ô∏è Modo Emulaci√≥n o ‚ö° WP-CLI Real)

POSIBLES ERRORES:
‚ùå "Error de conexi√≥n" ‚Üí Verificar URL y token
‚ùå "Plugin no encontrado" ‚Üí Verificar que el plugin est√© activado

===============================================================================
üîç PRUEBA 2: AUTODIAGN√ìSTICO AUTOM√ÅTICO
===============================================================================

OBJETIVO: Verificar que el autodiagn√≥stico funciona al conectar un sitio

PASOS:
1. Despu√©s de configurar el sitio, observar los mensajes autom√°ticos
2. Hacer clic en el bot√≥n üîç (diagn√≥stico manual) en el header

RESULTADOS ESPERADOS:
‚úÖ Mensaje "üîç Autodiagn√≥stico en progreso..."
‚úÖ Informaci√≥n detallada del servidor:
   - Versi√≥n de WordPress
   - Versi√≥n de PHP
   - Capacidades de ejecuci√≥n
   - Estado de WP-CLI
   - M√©todo recomendado

HOSTING RESTRICTIVO:
‚úÖ "ü§ñ Hola! He detectado que tu hosting es restrictivo. Activando Modo de Emulaci√≥n Nativa"

HOSTING CON WP-CLI:
‚úÖ "üöÄ Autodiagn√≥stico completado - Modo de Alto Rendimiento Activado"

===============================================================================
üß† PRUEBA 3: MEMORIA A CORTO PLAZO
===============================================================================

OBJETIVO: Verificar que Gemini recuerda conversaciones previas

PASOS:
1. Enviar mensaje: "Lista todos los plugins"
2. Esperar respuesta y ejecutar el comando
3. Enviar mensaje: "¬øCu√°ntos plugins activos hay?"
4. Enviar mensaje: "Desactiva el plugin que mencion√© antes"
5. Hacer clic en üß† para limpiar memoria
6. Enviar mensaje: "¬øQu√© plugins mencion√© antes?"

RESULTADOS ESPERADOS:
‚úÖ Pasos 2-4: Gemini hace referencia a plugins mencionados anteriormente
‚úÖ Paso 5: Mensaje "üß† Memoria limpiada"
‚úÖ Paso 6: Gemini no recuerda plugins anteriores (memoria limpia)

VERIFICAR EN CONSOLA:
- "üß† Historial actualizado: X mensajes"
- "üß† Enviando historial de conversaci√≥n: S√≠ (X mensajes)"

===============================================================================
üé® PRUEBA 4: CAPACIDADES DE DISE√ëO DE CONTENIDO
===============================================================================

OBJETIVO: Verificar que Gemini puede crear contenido con bloques de WordPress

PASOS:
1. Enviar: "Crea una p√°gina de inicio con un saludo y dos columnas de servicios"
2. Ejecutar el comando generado
3. Enviar: "Crea un post sobre WordPress con encabezados y listas"
4. Ejecutar el comando generado
5. Verificar en WordPress admin que las p√°ginas/posts se crearon correctamente

RESULTADOS ESPERADOS:
‚úÖ Comandos generados incluyen --post_content con bloques HTML:
   - <!-- wp:heading {"level":1} --><h1>T√≠tulo</h1><!-- /wp:heading -->
   - <!-- wp:columns --> con estructura de columnas
   - <!-- wp:paragraph --><p>Texto</p><!-- /wp:paragraph -->
‚úÖ Contenido se crea correctamente en WordPress
‚úÖ Bloques se muestran correctamente en el editor Gutenberg

COMANDOS ESPERADOS:
- wp post create --post_type=page --post_title="Inicio" --post_content='...' --post_status=publish
- wp post create --post_title="..." --post_content='...' --post_status=draft

===============================================================================
üîß PRUEBA 5: AUTO-HEALING (RECUPERACI√ìN AUTOM√ÅTICA)
===============================================================================

OBJETIVO: Verificar que el sistema detecta errores y sugiere soluciones

PASOS:
1. Enviar: "Instala el plugin que-no-existe-12345"
2. Ejecutar el comando (deber√≠a fallar)
3. Observar la respuesta de auto-healing
4. Enviar: "Crea un usuario con email inv√°lido"
5. Ejecutar el comando (deber√≠a fallar)
6. Observar la respuesta de auto-healing

RESULTADOS ESPERADOS:
‚úÖ Bot√≥n cambia a "‚ùå Error detectado"
‚úÖ Aparece "üîß Asistente de Recuperaci√≥n"
‚úÖ Mensaje: "üîß Analizando el error y buscando soluciones..."
‚úÖ Sugerencia de Gemini con comando alternativo
‚úÖ Bot√≥n "üîÑ Probar Soluci√≥n"

ERRORES A PROBAR:
- Plugin no existe ‚Üí Sugerencia de listar plugins disponibles
- Permisos denegados ‚Üí Verificar usuarios administradores
- Usuario ya existe ‚Üí Usar nombre diferente

===============================================================================
üö¶ PRUEBA 6: RATE LIMITING (L√çMITES DE USO)
===============================================================================

OBJETIVO: Verificar que los l√≠mites de 50 consultas/hora funcionan para usuarios gratuitos

PREPARACI√ìN:
1. Asegurarse de NO tener API Key personal configurada
2. Usar navegador en modo inc√≥gnito o limpiar localStorage

PASOS:
1. Enviar m√∫ltiples mensajes (puedes hacer 45+ consultas):
   - "wp --version"
   - "wp plugin list"
   - "wp user list"
   - "wp theme list"
   - ... (contin√∫a hasta llegar cerca de 50)
2. Intentar enviar consulta #51: "wp core version"
3. Verificar endpoint de estado: http://localhost:3001/api/rate-limit/status

RESULTADOS ESPERADOS:
‚úÖ Primeras 50 consultas: funcionan normalmente
‚úÖ Consulta #51: Error "Has agotado tus 50 consultas gratuitas por hora. Agrega tu propia API Key en configuraci√≥n para seguir"
‚úÖ Endpoint de estado muestra: remaining: 0, used: 50

CON API KEY PERSONAL:
1. Configurar API Key personal en el sitio
2. Enviar m√°s de 50 mensajes
‚úÖ Sin l√≠mites, todas las consultas funcionan

NOTA: Este l√≠mite alto (50) permite probar todas las funcionalidades sin restricciones.

===============================================================================
üè≠ PRUEBA 7: ESTABILIDAD INDUSTRIAL
===============================================================================

OBJETIVO: Verificar retry logic y manejo robusto de errores

PASOS:
1. Desconectar internet temporalmente
2. Enviar mensaje: "wp plugin list"
3. Reconectar internet
4. Observar comportamiento de retry

SIMULACI√ìN DE ERRORES DE API:
1. Modificar temporalmente GEMINI_API_KEY en .env con clave inv√°lida
2. Enviar mensaje: "wp --version"
3. Observar sistema de emergencia
4. Restaurar API key correcta

RESULTADOS ESPERADOS:
‚úÖ Retry autom√°tico con backoff exponencial
‚úÖ Mensajes de error claros y espec√≠ficos
‚úÖ Sistema de emergencia funciona cuando Gemini falla
‚úÖ Logs detallados en consola del servidor

VERIFICAR EN CONSOLA DEL SERVIDOR:
- "üîÑ Intento 1/2 de llamada a Gemini"
- "‚ùå Intento 1 fall√≥: [error]"
- "‚è≥ Esperando 1000ms antes del siguiente intento..."

===============================================================================
üîÑ PRUEBA 8: FLUJO COMPLETO DE DIAGN√ìSTICO
===============================================================================

OBJETIVO: Simular un problema real y verificar el flujo completo

ESCENARIO: "Mi sitio est√° lento"

PASOS:
1. Enviar: "Mi sitio est√° muy lento, ¬øqu√© puede ser?"
2. Ejecutar el comando sugerido por Gemini
3. Bas√°ndose en los resultados, enviar: "Hay muchos plugins activos"
4. Ejecutar comando de desactivaci√≥n sugerido
5. Enviar: "¬øC√≥mo verifico si mejor√≥ el rendimiento?"

RESULTADOS ESPERADOS:
‚úÖ Gemini sugiere revisar plugins activos (no solo traducir el problema)
‚úÖ An√°lisis inteligente de los resultados
‚úÖ Sugerencias espec√≠ficas basadas en el contexto
‚úÖ Memoria de la conversaci√≥n previa
‚úÖ Comandos seguros (is_safe: true para consultas)

===============================================================================
üõ°Ô∏è PRUEBA 9: SEGURIDAD Y VALIDACI√ìN
===============================================================================

OBJETIVO: Verificar que los comandos peligrosos se marcan correctamente

PASOS:
1. Enviar: "Borra todos los posts"
2. Observar advertencia de seguridad
3. Enviar: "Elimina la base de datos"
4. Observar advertencia de seguridad
5. Enviar: "Lista los usuarios"
6. Verificar que se marca como seguro

RESULTADOS ESPERADOS:
‚úÖ Comandos peligrosos: is_safe: false
‚úÖ Advertencia: "‚ö†Ô∏è Comando requiere precauci√≥n"
‚úÖ Mensaje: "Este comando puede modificar datos importantes"
‚úÖ Comandos de consulta: is_safe: true
‚úÖ Mensaje: "‚úÖ Comando seguro"

===============================================================================
üìä PRUEBA 10: M√öLTIPLES SITIOS
===============================================================================

OBJETIVO: Verificar gesti√≥n de m√∫ltiples sitios WordPress

PASOS:
1. Configurar 2-3 sitios diferentes
2. Cambiar entre sitios usando el selector
3. Verificar que el autodiagn√≥stico se ejecuta al cambiar
4. Enviar comandos en diferentes sitios
5. Verificar que cada sitio mantiene su contexto

RESULTADOS ESPERADOS:
‚úÖ M√°ximo 5 sitios permitidos
‚úÖ Cambio de sitio ejecuta autodiagn√≥stico autom√°tico
‚úÖ Contexto espec√≠fico por sitio
‚úÖ √öltimo sitio usado se recuerda
‚úÖ Datos se guardan por 30 d√≠as

===============================================================================
üö® PRUEBA 11: MANEJO DE ERRORES EXTREMOS
===============================================================================

OBJETIVO: Verificar comportamiento en condiciones adversas

PASOS:
1. Configurar sitio con URL incorrecta
2. Configurar sitio con token incorrecto
3. Enviar mensaje muy largo (>10,000 caracteres)
4. Desactivar el plugin de WordPress temporalmente
5. Cambiar puerto del servidor Node.js

RESULTADOS ESPERADOS:
‚úÖ Errores claros y espec√≠ficos
‚úÖ No crashes de la aplicaci√≥n
‚úÖ Mensajes de error informativos
‚úÖ Recuperaci√≥n autom√°tica cuando sea posible
‚úÖ Logs detallados para debugging

===============================================================================
üìà PRUEBA 12: RENDIMIENTO Y MEMORIA
===============================================================================

OBJETIVO: Verificar que no hay memory leaks y el rendimiento es bueno

PASOS:
1. Enviar 20+ mensajes consecutivos
2. Verificar uso de memoria en el navegador (F12 ‚Üí Performance)
3. Dejar la aplicaci√≥n abierta por 30+ minutos
4. Verificar limpieza autom√°tica de rate limits en servidor

RESULTADOS ESPERADOS:
‚úÖ Memoria estable (no crece indefinidamente)
‚úÖ Historial limitado a 5 mensajes
‚úÖ Limpieza autom√°tica cada 30 minutos
‚úÖ Respuestas r√°pidas (<2 segundos)

VERIFICAR EN CONSOLA DEL SERVIDOR:
- "üßπ Ejecutando limpieza autom√°tica de rate limits..."
- "üìä Rate limits activos: X"

===============================================================================
‚úÖ CHECKLIST FINAL DE VERIFICACI√ìN
===============================================================================

FUNCIONALIDADES B√ÅSICAS:
‚ñ° Configuraci√≥n de sitios funciona
‚ñ° Conexi√≥n con WordPress exitosa
‚ñ° Comandos WP-CLI se ejecutan correctamente
‚ñ° Interfaz responde correctamente

FUNCIONALIDADES AVANZADAS:
‚ñ° Autodiagn√≥stico autom√°tico funciona
‚ñ° Memoria a corto plazo (5 mensajes)
‚ñ° Capacidades de dise√±o de contenido
‚ñ° Auto-healing detecta y sugiere soluciones
‚ñ° Rate limiting (3 consultas/hora sin API key)

GRADO INDUSTRIAL:
‚ñ° Retry logic con backoff exponencial
‚ñ° Manejo robusto de errores
‚ñ° Validaci√≥n de entrada
‚ñ° Limpieza autom√°tica de memoria
‚ñ° Logs detallados y debugging
‚ñ° Sistema de emergencia funcional

SEGURIDAD:
‚ñ° Comandos peligrosos marcados correctamente
‚ñ° Validaci√≥n de tokens
‚ñ° Sanitizaci√≥n de entrada
‚ñ° Manejo seguro de API keys

EXPERIENCIA DE USUARIO:
‚ñ° Mensajes claros y informativos
‚ñ° Interfaz intuitiva
‚ñ° Animaciones y feedback visual
‚ñ° Gesti√≥n de m√∫ltiples sitios

===============================================================================
üêõ SOLUCI√ìN DE PROBLEMAS COMUNES
===============================================================================

PROBLEMA: "Error de conexi√≥n con WordPress"
SOLUCI√ìN: 
- Verificar que el plugin est√© activado
- Verificar URL (sin /wp-json al final)
- Verificar token de seguridad

PROBLEMA: "Endpoint no encontrado" al ejecutar comandos
SOLUCI√ìN: ‚úÖ YA CORREGIDO AUTOM√ÅTICAMENTE
- Endpoint /api/wp-cli/execute faltante ‚Üí Creado
- Comunicaci√≥n servidor ‚Üî WordPress plugin implementada
- Reiniciar servidor: cd web-app && npm start

PROBLEMA: "models/gemini-1.5-flash is not found for API version v1beta"
SOLUCI√ìN: ‚úÖ YA CORREGIDO AUTOM√ÅTICAMENTE
- Modelo actualizado a gemini-2.5-flash
- Google deprec√≥ el modelo 1.5-flash en diciembre 2025
- Reiniciar servidor: cd web-app && npm start

PROBLEMA: "Gemini AI no responde"
SOLUCI√ìN:
- Verificar API key en .env
- Verificar conexi√≥n a internet
- Sistema de emergencia deber√≠a activarse autom√°ticamente

PROBLEMA: "Rate limit no funciona"
SOLUCI√ìN:
- Usar navegador inc√≥gnito
- Verificar que no hay API key personal configurada
- Verificar logs del servidor
- NOTA: L√≠mite actual es 50 consultas/hora (aumentado para pruebas)

PROBLEMA: "Auto-healing no se activa"
SOLUCI√ìN:
- Verificar que el comando realmente falle
- Verificar logs en consola del navegador
- Probar con errores conocidos (plugin inexistente)

===============================================================================
üìù NOTAS IMPORTANTES
===============================================================================

1. LOGS: Siempre revisar consola del navegador (F12) y consola del servidor
2. TIMING: Algunas pruebas requieren esperar (rate limiting, cleanup)
3. ESTADO: Limpiar localStorage entre pruebas si es necesario
4. BACKUP: Hacer backup del sitio WordPress antes de pruebas destructivas
5. DOCUMENTACI√ìN: Anotar cualquier comportamiento inesperado

===============================================================================
üéØ CRITERIOS DE √âXITO
===============================================================================

La aplicaci√≥n pasa todas las pruebas si:
‚úÖ Todas las funcionalidades b√°sicas funcionan sin errores
‚úÖ Las funcionalidades avanzadas se comportan como se espera
‚úÖ Los errores se manejan graciosamente
‚úÖ El rendimiento es aceptable
‚úÖ La experiencia de usuario es fluida
‚úÖ Los logs muestran informaci√≥n √∫til para debugging

===============================================================================
FIN DE LA GU√çA DE PRUEBAS
===============================================================================

Esta gu√≠a cubre todas las funcionalidades implementadas en la aplicaci√≥n de
grado industrial. Sigue los pasos en orden para una evaluaci√≥n completa.

¬°Buena suerte con las pruebas! üöÄ